<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>计算机</title>
	</head>
	<body>
		<div id="navigation">
			<h1 style="opacity: 0.07;">一只计算鸡</h1>
		</div>
		
		<div id="computer_entirety">
			<div id="display_frame">
				<span id="computer_history01" class="computer_history">
					
				</span>
				<span id="computer_history02" class="computer_history">
					
				</span>
				<span id="computer_messege">
					0
				</span>
			</div>
			
			<div id="computer_div">
				<button type="button" class="basics-button btn-animation" onclick="onclickClear()">
					<span style="font-size: 18px;" class="arithmetic-button">AC</span>
				</button>
				<button type="button" class="basics-button btn-animation" onclick="onclickDelet()">
					<img src="img/delete.png" style="width: 20px;">
				</button>
				<button type="button" class="basics-button btn-animation" onclick="onclickArithmetic('%')">
					<span style="font-size: 18px; font-weight: 700;" class="arithmetic-button">％</span>
				</button>
				<button type="button" class="basics-button btn-animation" onclick="onclickArithmetic('÷')">
					<span class="arithmetic-button">÷</span>
				</button>
				<br>
				<button type="button" class="basics-button btn-animation" onclick="onclickNum(7)">
					<span class="text-button">7</span>
				</button>
				<button type="button" class="basics-button btn-animation" onclick="onclickNum(8)">
					<span class="text-button">8</span>
				</button>
				<button type="button" class="basics-button btn-animation" onclick="onclickNum(9)">
					<span class="text-button">9</span>
				</button>
				<button type="button" class="basics-button btn-animation" onclick="onclickArithmetic('×')">
					<span class="arithmetic-button">×</span>
				</button>
				<br>
				<button type="button" class="basics-button btn-animation" onclick="onclickNum(4)">
					<span class="text-button">4</span>
				</button>
				<button type="button" class="basics-button btn-animation" onclick="onclickNum(5)">
					<span class="text-button">5</span>
				</button>
				<button type="button" class="basics-button btn-animation" onclick="onclickNum(6)">
					<span class="text-button">6</span>
				</button>
				<button type="button" class="basics-button btn-animation" onclick="onclickArithmetic('-')">
					<span class="arithmetic-button">-</span>
				</button>
				<br>
				<button type="button" class="basics-button btn-animation" onclick="onclickNum(1)">
					<span class="text-button">1</span>
				</button>
				<button type="button" class="basics-button btn-animation" onclick="onclickNum(2)">
					<span class="text-button">2</span>
				</button>
				<button type="button" class="basics-button btn-animation" onclick="onclickNum(3)">
					<span class="text-button">3</span>
				</button>
				<button type="button" class="basics-button btn-animation"  onclick="onclickArithmetic('+')">
					<span class="arithmetic-button">+</span>
				</button>
				<br>
				<button type="button" class="basics-button btn-animation" onclick="console.log('被你找到了^-^')">
					<span>Jove</span>
				</button>
				<button type="button" class="basics-button btn-animation"  onclick="onclickNum(0)">
					<span class="text-button">0</span>
				</button>
				<button type="button" class="basics-button btn-animation" onclick="onclickNum('.')">
					<span class="text-button">.</span>
				</button>
				<button type="button" class="basics-button btn-animation" onclick="onclickGetResult()">
					<span class="arithmetic-button">=</span>
				</button>
			</div>
		</div>
		
		
		<script type="text/javascript">
			
			var isresult = false;							// 是否有结果
			
			var computer_messege = document.getElementById("computer_messege");
			var computer_history01 = document.getElementById("computer_history01");
			var computer_history02 = document.getElementById("computer_history02");
			var numArr = ['0','1','2','3','4','5','6','7','8','9','%'];
						
			function onclickGetResult()
			{
				str = computer_messege.innerText;
				str = str.replace(/×/g, '*');	// 将字符串转换为可计算的表达式
				str = str.replace(/÷/g, '/');
				str = str.replace(/%/g,'/100');
				console.log(str);
				computer_messege.innerText = eval(str);
				isresult = true;							// 判断得出结果
			}
			function onclickArithmetic(Ari)
			{
				var str = computer_messege.innerText;
				if(numArr.indexOf(str.charAt(str.length-1)) == -1)
				{
					onclickDelet();
					onclickNum(Ari);
					// 不能重复输入计算符
					return;
				}
				onclickNum(Ari);
			}
			function onclickClear()
			{
				computer_messege.innerText = "0";
				computer_history01.innerText = "";
				computer_history02.innerText = "";
			}
			function onclickDelet()
			{
				console.log("del");
				if(computer_messege.innerText.length == 1)
				{
					computer_messege.innerText = "0";
					console.log("del已清空");
					return;									// 计算区为0时无效操作
				}
				else
				{
					str = computer_messege.innerText;
					computer_messege.innerText = str.substr(0,str.length-1);
					// 取除最后一位
				}
			}
			function onclickNum(num)
			{				
				if(isresult)
				{
					// 已经出结果时输入则更新历史记录并开始新的计算
					computer_history01.innerText = computer_history02.innerText;
					computer_history02.innerText = computer_messege.innerText;
					computer_messege.innerText = num;
					isresult = false;						// 新的开始
				}
				else if(computer_messege.innerText == 0)
				{
					computer_messege.innerText = num;
				}
				else
				{
					computer_messege.innerText += num;
				}				
			}
			document.onkeydown = function(event){
				event = event || window.event;
				console.log(event.key);
				switch(event.key)
				{
					case '0':
						onclickNum(0);
						break;
					case '1':
						onclickNum(1);
						break;
					case '2':
						onclickNum(2);
						break;
					case '3':
						onclickNum(3);
						break;
					case '4':
						onclickNum(4);
						break;
					case '5':
						onclickNum(5);
						break;
					case '6':
						onclickNum(6);
						break;
					case '7':
						onclickNum(7);
						break;
					case '8':
						onclickNum(8);
						break;
					case '9':
						onclickNum(9);
						break;
					case '.':
						onclickNum('.');
						break;
					case '+':
						onclickArithmetic('+');
						break;
					case '-':
						onclickArithmetic('-');
						break;
					case '*':
						onclickArithmetic('×');
						break
					case '/':
						onclickArithmetic('÷');
						break;
					case 'Backspace':
						event.preventDefault();				// 取消默认操作
						onclickDelet();
						break;
					case 'Enter':
						event.preventDefault();
						onclickGetResult();
						break;
					case 'Control':
						event.preventDefault();
						onclickClear();
						break;
					default:
						break
				}
			}
			
		</script>
		
		
		<style type="text/css">
			*{
				margin: 0;
				padding: 0;
				/* 取消所有默认外边距和内边距 */
			}
			h1{
				text-align: center;
				margin: 20px;
				padding: 20px;
			}
			#computer_entirety{
				background-color: #f8fafe;
				padding: 20px;
				width: 380px;
				margin: auto;
				border: 1px solid #ccd1dc;
				box-shadow: 7px 7px 5px #888888;				/* 阴影 */
				border-radius: 10px;
				font-size: 0px;
			}
			#navigation{
				margin-bottom: 60px;
			}
			#display_frame{
				width: 360px;
				height: 120px;
				background-color: #414141;
				padding: 0px 10px 0px 10px;						/* 上右下左 */
				box-shadow: 0px 2px 4px 0px rgb(73,114,197,0.5);		/* 阴影 */
				border-radius: 9px;
			}
			#computer_div{
				margin-top: 20px;
				padding-left: 10px;
				width: 380px;
			}
			#computer_messege{
				display: flex;									/* 弹性布局 */
				justify-content:flex-end;						/* 右对齐 */
				font-size: 32px;
				color: white;
				margin-right: 10px;
			}
			.computer_history{
				margin-right: 10px;
				height: 25px;
				display: flex;									/* 弹性布局 */
				justify-content:flex-end;						/* 右对齐 */
				padding: 5px;
				font-size: 19px;
				color: whitesmoke;
				opacity: 0.4;									/* 透明度 */
			}
			.basics-button{
				border-radius: 30px;							/* 圆角 */
				overflow: hidden;								/* 隐藏溢出的径向渐变背景 */
				position: relative;								/* 相对定位 */
				cursor: pointer;								/* 光标改为小手 */
				box-shadow: 0px 2px 4px 0px rgb(73,114,197,0.2);		/* 阴影 */
				outline: none;									/* 隐藏黑边 */
				width: 80px;
				height: 75px;
				padding: 0;
				margin: 5px;
				border-style: none;
				/* background-color: black; */
				background-color: transparent;					/* 透明背景 */
			}
			.text-button{
				color: #3e4044;
				font-size: 22px;
				font-weight: 500;
			}
			.arithmetic-button{
				color: #e55026;
				font-size: 26px;
				font-weight: 500;
			}
			/* 按钮按下动效 */
			.basics-button:hover{
				background-color: #f0f3f8;
			}
			.basics-button:active{
				box-shadow: box-shadow
					7px 6px 28px 1px rgba(0, 0, 0, 0.24);				
				transform: translateY(2px);
			}
			/* 按钮扩展动效 */
			.btn-animation::after {
				content: '';										/* 定义元素之前或之后放置的生成内容 */
				position: absolute;									/* 绝对定位 */
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background-image: radial-gradient(circle, #ccc 10%, transparent 10.1%);		/* 径向渐变 */
				transform: scale(10);								/* 定义 2D 缩放转换 */
				opacity: 0;
				transition: all .4s;								/* 过渡动画 */
			}
			.btn-animation:active::after {
				transform: scale(0);
				opacity: .5;
				transition: 0s;
			}
		</style>
	</body>
</html>
